<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login / Sign Up - Lj Silver Jewellery</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="style.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <style>
        /* Auth Page Specific Styles */
        .auth-container {
            max-width: 450px;
            margin: 50px auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            padding: 30px;
            min-height: 500px;
        }

        .auth-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .auth-header h2 {
            color: #333;
            margin-bottom: 10px;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid #f0f0f0;
        }

        .auth-tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            cursor: pointer;
            font-weight: bold;
            color: #888;
            transition: 0.3s;
            font-size: 1.1rem;
        }

        .auth-tab:hover {
            color: #555;
            background: #fafafa;
        }

        .auth-tab.active {
            color: #333;
            border-bottom: 3px solid #333;
        }

        .auth-form {
            display: none;
            animation: fadeIn 0.5s;
        }

        .auth-form.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: bold;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: 0.3s;
        }

        .form-group input:focus {
            border-color: #333;
            outline: none;
        }

        .submit-btn {
            width: 100%;
            padding: 14px;
            background: #333;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
            margin-top: 10px;
        }

        .submit-btn:hover {
            background: #555;
        }

        .message {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-size: 0.9rem;
            display: none;
        }

        .message.error {
            background: #fee;
            color: #c33;
            border: 1px solid #fcc;
        }

        .message.success {
            background: #efe;
            color: #3c3;
            border: 1px solid #cfc;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="hamburger" onclick="toggleMobileNav()">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div class="logo">LJ Silver</div>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="gallery.html">Gallery</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="login.html" class="active">Login</a></li>
            </ul>
        </nav>
        <div class="cart-icon">
            <a href="cart.html" style="color: #333; text-decoration: none;">
                <i class="fa fa-shopping-cart"></i>
            </a>
        </div>
        <nav class="nav-mobile" id="navMobile">
            <a href="index.html">Home</a>
            <a href="gallery.html">Gallery</a>
            <a href="about.html">About</a>
            <a href="contact.html">Contact</a>
            <a href="login.html">Login</a>
        </nav>
    </header>

    <!-- Auth Container -->
    <div class="auth-container">
        <div class="auth-header">
            <h2>Welcome Back</h2>
            <p>Access your account to manage orders</p>
        </div>

        <div class="auth-tabs">
            <div class="auth-tab active" onclick="switchTab('login')">Login</div>
            <div class="auth-tab" onclick="switchTab('signup')">Sign Up</div>
        </div>

        <!-- Login Form -->
        <form id="loginForm" class="auth-form active" onsubmit="handleLogin(event)">
            <div class="form-group">
                <label>Email Address</label>
                <input type="email" id="loginEmail" required placeholder="Enter your email">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="loginPassword" required placeholder="Enter your password">
            </div>
            <button type="submit" class="submit-btn">Login</button>
            <div id="loginMsg" class="message"></div>
        </form>

        <!-- Sign Up Form -->
        <form id="signupForm" class="auth-form" onsubmit="handleSignup(event)">
            <div class="form-group">
                <label>Full Name</label>
                <input type="text" id="regName" required placeholder="Your full name">
            </div>
            <div class="form-group">
                <label>Email Address</label>
                <input type="email" id="regEmail" required placeholder="Your email address">
            </div>
            <div class="form-group">
                <label>Phone Number</label>
                <input type="tel" id="regPhone" required placeholder="Your phone number">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="regPassword" required placeholder="Create a password">
            </div>
            <button type="submit" class="submit-btn">Create Account</button>
            <div id="signupMsg" class="message"></div>
        </form>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBdUeX8etc9aNhsr1uHwdfbsgutcR1Yaec",
            authDomain: "ljsilverj.firebaseapp.com",
            projectId: "ljsilverj",
            storageBucket: "ljsilverj.firebasestorage.app",
            messagingSenderId: "21343936386",
            appId: "1:21343936386:web:ba870e9787704c01bff99b",
            databaseURL: "https://ljsilverj-default-rtdb.firebaseio.com"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const auth = firebase.auth();

        function switchTab(tab) {
            // Update tabs UI
            document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            // Show correct form
            document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
            document.getElementById(tab + 'Form').classList.add('active');

            // Clear messages
            document.querySelectorAll('.message').forEach(m => m.style.display = 'none');
        }

        function handleSignup(e) {
            e.preventDefault();
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const phone = document.getElementById('regPhone').value;
            const password = document.getElementById('regPassword').value;
            const msg = document.getElementById('signupMsg');

            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // User created, now save details to Database
                    const user = userCredential.user;
                    return db.ref('users/' + user.uid).set({
                        name: name,
                        email: email,
                        phone: phone
                    });
                })
                .then(() => {
                    msg.textContent = 'Account created successfully! Please login.';
                    msg.className = 'message success';
                    msg.style.display = 'block';
                    document.getElementById('signupForm').reset();
                    setTimeout(() => { document.querySelectorAll('.auth-tab')[0].click(); }, 1500);
                })
                .catch((error) => {
                    msg.textContent = error.message;
                    msg.className = 'message error';
                    msg.style.display = 'block';
                });
        }

        function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const msg = document.getElementById('loginMsg');

            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // Fetch user details to store in localStorage for display
                    const userId = userCredential.user.uid;
                    return db.ref('users/' + userId).once('value');
                })
                .then((snapshot) => {
                    const userData = snapshot.val();
                    localStorage.setItem('currentUser', JSON.stringify(userData));
                    
                    msg.textContent = 'Login successful! Redirecting...';
                    msg.className = 'message success';
                    msg.style.display = 'block';
                    setTimeout(() => { window.location.href = 'index.html'; }, 1000);
                })
                .catch((error) => {
                    msg.textContent = 'Invalid email or password.';
                    msg.className = 'message error';
                    msg.style.display = 'block';
                });
        }

        function toggleMobileNav() {
            const navMobile = document.getElementById('navMobile');
            const hamburger = document.querySelector('.hamburger');
            navMobile.classList.toggle('active');
            hamburger.classList.toggle('active');
        }
    </script>
</body>
</html>